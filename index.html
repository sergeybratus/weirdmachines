<!DOCTYPE html>
<html>
  <head>
    <title>Weird Machines HQ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
 </head>

<body>
<div class="container"> 
<div class="starter-template">

<h1>What are Weird Machines?</h1>


<p>&nbsp;</p>
<p>
The expression <b>"weird machines"</b> was first used in my invited talk at <a href="http://www.cs.dartmouth.edu/~sergey/hc/rss-hacker-research.pdf">RSS
2009</a>. It referred to state-of-the-art exploitation as finding
and programming an execution model (a machine, such as a virtual
automaton) within the target via crafted inputs. It was soon extended
to other methods of reliably or probabilistically influencing the
target's state.  A compressed version of that original talk was given at the
Chaos Computing Congress 27c3
<a href="http://events.ccc.de/congress/2010/Fahrplan/attachments/1807_ccc-hacker-research.pdf">[slides]</a>, <a href="http://www.youtube.com/watch?v=4sUmANLFD8s">[video]</a>.

<p>
The concept was further elaborated in 
<a href="http://immunityinc.com/infiltrate/archives/Fundamentals_of_exploitation_revisited.pdf">
Exploitation and State Machines</a> by Thomas Dullien / Halvar Flake at Infiltrate 2011,
<a href="http://census-labs.com/media/heap-owasp-appsec-2012.pdf">Heap Exploitation
Abstraction by Example</a> by Census Labs at <a href="http://log.cedricbonhomme.org/44d3fc878b97103d1ffd5dff7548ba0f0f6de05d/007b37438f20d1dad6e8c92bc5a7af6e414b2c08.html">OWASP 2012</a>, and
others. A historical sketch can be found in <a href="http://langsec.org/papers/Bratus.pdf">
From Buffer Overflows to "Weird Machines"</a> by Bratus et al. 

<p>
Effort is underway to produce formal descriptions of weird machine
classes in various computing environments. Thomas Dullien's 2017
paper <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=8226852">Weird
machines, exploitability, and provable unexploitability</a> is the
most notable recent development (see <a href="#formalisms">Formalisms</a> below).

<p>
The <a href="http://langsec.org">LangSec</a> effort is aimed
at describing and eliminating broad classes of input-related bugs and associated weird machines. 

<p>
<a name="formalisms"></a>
<h2>Beginnings of formalism</h2>
<ul>
  <li><i>Weird machines, exploitability, and provable unexploitability</i>,
    Thomas Dullien, IEEE Transactions on Emerging Topics in Computing, December 2017, 
    <a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=8226852">[PDF]</a>
    (also compare with <i>"Spectre is here to stay"</i> below)
  <li><i>Exploitation as Code Reuse: On the Need of Formalization</i>, Sergey Bratus, Anna Shubina, 
   Information Technology, vol. 59, no. 2, p. 93, 2017, 
    <a href="http://langsec.org/papers/exploitation-as-code-reuse-position-paper.pdf">[PDF]</a>
  <li><i>Weird Machines as Insecure Compilation</i>,
    Jennifer Paykin, Eric Mertens, Mark Tullsen, Luke Maurer, Benoît Razet, Alexander Bakst, Scott Moore,
    <a href="https://arxiv.org/abs/1911.00157">[arxiv.org]</a>. See also
    <a href="https://galois.com/project/seec/">Project SEEC</a> at Galois, Inc. 
</ul>

<p>
<h2>Recent related work</h2>
<ul>
  <li><i>Computing with time: microarchitectural weird machines</i>,
    Dmitry Evtyushkin, Thomas Benjamin, Jesse Elwell, Jeffrey A. Eitel, Angelo Sapello, Abhrajit Ghosh,
    ASPLOS 2021, 
    <a href="https://www.cs.wm.edu/~dmitry/assets/files/asplos21main-p460-p-9bfcb1ed4a-49511M-final.pdf">[PDF]</a>. The authors demonstrated that microarchitectural state could be used to construct virtual logic gates and circuits to carry out non-trivial computations entirely within the CPU transient space. They won a Distinguished paper award at ASPLOS.
  </li>
  
  <li><i>A deep dive into an NSO zero-click iMessage exploit: Remote Code Execution</i> by
     Ian Beer &amp; Samuel Groß of Google Project Zero, 2021, 
    <a href="https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html">[blog]</a>
    explains the construction of an almost pure example of a weird machine used in an actual exploit.
  </li>

  <li><i>Cross-Language Attacks</i> by
    Samuel Mergendahl, Nathan Burow &amp; Hamed Okhravi, NDSS 2022, 
    <a href="https://www.ndss-symposium.org/wp-content/uploads/2022-78-paper.pdf">[paper]</a>. A groundbreaking in-depth discussion of how weird machines emerge at the internal boundaries of complex logical components. 
  </li>
  
  <li><i>Spectre is here to stay: An analysis of side-channels and speculative execution</i>,
Ross Mcilroy, Jaroslav Sevcik, Tobias Tebbi, Ben L. Titzer, Toon Verwaest, 
  <a href="https://arxiv.org/abs/1902.05178">[paper]</a>. The authors introduce a mathematical meta-model that explains side-channels in simulations and CPUs, which appears to be directly comparable with the weird machine approach.
  </li> 

  <li><i>ExSpectre: Hiding Malware in Speculative Execution</i>, Jack Wampler, Ian Martiny, Eric Wustrow, NDSS 2019,  
   <a href="https://www.ndss-symposium.org/wp-content/uploads/2019/02/ndss2019_02B-5_Wampler_paper.pdf">[paper]</a>. The authors note that their results extend research in "weird machines".</li>      
    
  <li><i>Dedup Est Machina: Memory Deduplication as an Advanced Exploitation Vector</i>,
    Erik Bosman, Kaveh Razavi, Herbert Bos, Cristiano Giuffrida, IEEE Security and Privacy 2016,
    <a href="https://www.cs.vu.nl/~kaveh/pubs/pdf/dedup-sp16.pdf">[paper]</a>. The authors demonstrate that Windows 8.1-10 built-in memory deduplication feature combined with RowHammer yields a powerful weird machine. </li>
  <li><i>Framing Signals - A Return to Portable Shellcode</i>, 
    Erik Bosman, Herbert Bos, IEEE Security and Privacy 2014, 
  <a href="https://www.cs.vu.nl/~herbertb/papers/srop_sp14.pdf">[paper]</a>,
  <a href="https://en.wikipedia.org/wiki/Sigreturn-oriented_programming">[wikipedia]</a>. 
   The authors show that Unix signal handling mechanisms can be generically programmed 
   with fake signal frames to initiate returns from signals that the kernel never really 
   delivered.</li>   
</ul>

<p>
<h2>Original Papers</h2>
<ul>
  <li><i>"Weird Machines" in ELF: A Spotlight on the Underappreciated Metadata</i>, Shapiro et al., USENIX WOOT'13 
    <a href="woot13-shapiro.pdf">[paper]</a>,
    <a href="https://www.usenix.org/sites/default/files/conference/protected-files/shapiro_woot13_slides.pdf">[slides]</a>,
    <a href="https://www.usenix.org/conference/woot13/%E2%80%9Cweird-machines%E2%80%9D-elf-spotlight-underappreciated-metadata">[video]</a>,
    <a href="https://www.usenix.org/conference/woot13/%E2%80%9Cweird-machines%E2%80%9D-elf-spotlight-underappreciated-metadata">[mp3]</a>.
 
  <li><i>The Page-Fault Weird Machine: Lessons in Instruction-less Computation</i>, Bangert et al., USENIX WOOT'13 
    <a href="woot13-bangert.pdf">[paper]</a>,
    <a href="https://www.usenix.org/conference/woot13/page-fault-weird-machine-lessons-instruction-less-computation">[video]</a>,
    <a href="https://www.usenix.org/conference/woot13/page-fault-weird-machine-lessons-instruction-less-computation">[mp3]</a>.
  <li><i>The Weird Machines in Proof-Carrying Code</i>, Julien Vanegue, 1st IEEE Language-theoretic Security &amp; Privacy Workshop, 2014, 
   <a href="http://openwall.info/wiki/_media/people/jvanegue/files/vanegue_langsec14.pdf">[paper]</a>.

  <li><i>Exploiting the Hard-Working DWARF: Trojan and Exploit Techniques with No Native Executable Code</i>, Oakley &amp; Bratus, USENIX WOOT'11
   <a href="https://www.usenix.org/legacy/events/woot11/tech/final_files/Oakley.pdf">[paper]</a>,
   <a href="https://www.usenix.org/legacy/multimedia/woot11oakley">[video]</a>,
   <a href="https://www.usenix.org/legacy/events/woot11/tech/slides/oakley.pdf">[slides]</a>,
   <a href="http://www.usenix.org/conference/woot11/exploiting-hard-working-dwarf-trojan-and-exploit-techniques-no-native-executable">[mp3]</a>.
</ul>

<p>
<h2>Historical overviews</h2>
<ul>
 <li><i>Exploit Programming: from Buffer Overflows to Weird Machines and Theory of Computation</i>, 
   Sergey Bratus, Michael E. Locasto, Meredith L. Patterson, Len Sassaman, Anna Shubina, USENIX ;login: 2011 
   <a href="http://langsec.org/papers/Bratus.pdf">[PDF]</a>
  <li><i>The Halting Problems of Internet Insecurity</i>, Len Sassaman, Meredith L. Patterson, Sergey Bratus, Anna Shubina, USENIX ;login: 2011  
   <a href="http://langsec.org/papers/Sassaman.pdf">[PDF]</a>
</ul>


<p>
<h2>Strange &amp; radiant machines</h2>
(exploits that borrow existing computation in unexpected ways)

<p>
<h3>PHY layer</h3>
<ul>
  <li><i>Packets in Packets: Orson Welles' In-Band Signaling Attacks for Modern Radios</i>, Goodspeed et al., USENIX WOOT'11
   <a href="https://www.usenix.org/legacy/event/woot11/tech/final_files/Goodspeed.pdf">[paper]</a>,
   <a href="http://travisgoodspeed.blogspot.com/2011/09/remotely-exploiting-phy-layer.html">[blog]</a>,
   <a href="https://www.usenix.org/legacy/multimedia/woot11goodspeed">[video]</a> -- borrows simple
     machines in digital radio PHY layer.
  <li><i>Phantom Boundaries and Cross-layer Illusions in 802.15.4 Digital Radio</i>, Travis Goodspeed, 1st IEEE Language-theoretic Security &amp; Privacy Workshop, 2014,
        <a href="http://spw14.langsec.org/papers/8th-of-a-nybble.pdf">[paper]</a>.
  <li><i>Fully arbitrary 802.3 packet injection: maximizing the Ethernet attack surface</i>, Barisani et al. BlackHat USA
   <a href="https://media.blackhat.com/us-13/US-13-Barisani-Fully-Arbitrary-802-3-Packet-Injection-WP.pdf">[paper]</a>
   <a href="https://media.blackhat.com/us-13/US-13-Barisani-Fully-Arbitrary-802-3-Packet-Injection-Slides.pdf">[slides]</a> -- includes packet-in-packet for 802.3/Ethernet
  </ul>
  See also <a href="http://babylonphy.org">BabylonPHY.org</a>, 
           <a href="http://demystiphy.org">DemystiPHY.org</a>.

<h3>Embedded Systems</h3>
<ul>
  <li><i>Interrupt-oriented bugdoor programming: a minimalist approach to bugdooring embedded systems firmware</i>,
     	Samuel J. Tan, Sergey Bratus, Travis Goodspeed, ACSAC 2014 
   <a href="https://tcipg.org/sites/default/files/papers/2014_q3_tfs1.pdf">[PDF]</A>
</ul>

<h3>Higher network layers</h3>
<ul>
  <li>BGP: <i>Using Routers to Build Logic Circuits: How Powerful is BGP?</i>, Marco Chiesa et al., 2013, 
     <a href="http://vanbever.eu/pdfs/vanbever_turing_icnp_2013.pdf">[paper]</a>; 
     <i>Computing with BGP: from Routing Configurations to Turing Machines</i>, Marco Chiesa et al., 2012,
     <a href="http://vanbever.eu/pdfs/vanbever_turing_bgp_tr_2012.pdf">[paper]</a>
</ul>


<h3>Intra-OS machines</h3>
<ul>
   <li>Julia
   Wolf's <a href="http://cansecwest.com/slides/2013/Analysis%20of%20a%20Windows%20Kernel%20Vuln.pdf">Analysis
   of the Windows Kernel TrueType Font Engine Vulnerability
   (MS11-087)</a> -- programs the TTF rendering automaton with a crafted font to "render" over kernel memory.
  <li>Tavis Ormandy's <a href="http://blog.cmpxchg8b.com/2012/09/fun-with-constrained-programming.html">
Fun with Constrained Programming</a>  --<i>"Believe it or not, RAR files can contain bytecode for a simple x86-like virtual machine called the RarVM. [..]</i>
</ul>

<!--
<h3></h3>
<ul>
  <li>  <a href=""></a>
</ul>
-->

<!--
<h3></h3>
<ul>
  <li>  <a href=""></a>
</ul>
-->


<h3>Other papers on x86</h3>
<ul>
  <li>Stephen Dolan, <a href="http://www.cl.cam.ac.uk/~sd601/papers/mov.pdf"><tt>mov</tt> is Turing-complete</a>
     (caveat: one <tt>jmp</tt> is still necessary to complete the machine)
  <li>Now implemented in a real compiler <a href="https://github.com/xoreaxeaxeax/movfuscator/">https://github.com/xoreaxeaxeax/movfuscator/</a> by Christopher Domas (@xoreaxeaxeax) (presented at <a href="http://recon.cx">Recon 2015</a>). MOVfuscator uses a neat trick to get rid of the <tt>jmp</tt> for the global loop needed by Dolan's paper; now a program is pure MOVs!) 

  <li>keegan @ <i>main is usually a function</i> blog: <a href="http://mainisusuallyafunction.blogspot.com/2014/02/x86-is-turing-complete-with-no-registers.html">x86 is Turing-complete with no registers</a>
</ul>



<h3>Games</h3>
<ul>
  <li>0xabad1dea's <a href="https://gist.github.com/0xabad1dea/7740977">Index of Weird Machines in Video Games</a>
</ul>

<h3>Other Lists</h3>
<ul>
  <li><a href="http://beza1e1.tuxen.de/articles/accidentally_turing_complete.html">Accidentally Turing-Complete</a>, by Andreas Zwinkau
</ul>



</div> <!-- container -->
</div> <!-- starter-template -->
</body>
</html>
